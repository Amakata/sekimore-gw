[global]
logfile="/var/log/ulog/ulogd.log"

# Plugin loading
# Note: Paths may vary by architecture (x86_64, aarch64, etc.)
# Adjust the plugin paths based on your system architecture
# Common paths:
#   x86_64: /usr/lib/x86_64-linux-gnu/ulogd/
#   aarch64: /usr/lib/aarch64-linux-gnu/ulogd/
plugin="/usr/lib/x86_64-linux-gnu/ulogd/ulogd_inppkt_NFLOG.so"
plugin="/usr/lib/x86_64-linux-gnu/ulogd/ulogd_raw2packet_BASE.so"
plugin="/usr/lib/x86_64-linux-gnu/ulogd/ulogd_filter_IP2STR.so"
plugin="/usr/lib/x86_64-linux-gnu/ulogd/ulogd_filter_IFINDEX.so"
plugin="/usr/lib/x86_64-linux-gnu/ulogd/ulogd_filter_PRINTPKT.so"
plugin="/usr/lib/x86_64-linux-gnu/ulogd/ulogd_output_LOGEMU.so"

# Stack definition (pipeline)
stack=log1:NFLOG,base1:BASE,ip2str1:IP2STR,ifi1:IFINDEX,print1:PRINTPKT,emu1:LOGEMU

[log1]
group=1           # NFLOG group number
bind=1
unbind=0

[emu1]
file="/var/log/ulog/firewall.log"
sync=1            # Write to disk immediately
