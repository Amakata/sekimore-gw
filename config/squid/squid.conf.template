# Squid Proxy Configuration for AI Security Gateway
# Generated by Sekimore orchestrator

# Access Control Lists (ACLs)
acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 443         # https
acl Safe_ports port 53          # dns
acl CONNECT method CONNECT

# Allowed domains (dynamically generated)
{ALLOWED_DOMAINS_ACL}

# Deny requests to non-safe ports
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

# Allow localhost
http_access allow localhost manager
http_access deny manager

# Allow whitelisted domains
http_access allow allowed_domains

# Deny all other access
http_access deny all

# Listening port
http_port 3128

# Cache settings
{CACHE_CONFIG}

# Upstream proxy (企業プロキシ連携)
{UPSTREAM_PROXY_CONFIG}

# Logging
access_log /var/log/squid/access.log squid
cache_log /var/log/squid/cache.log

# DNS settings
dns_nameservers {DNS_NAMESERVERS}

# Misc
coredump_dir /var/spool/squid
refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320
